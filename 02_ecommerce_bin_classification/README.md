# Моделирование коэффициента удовлетворённости работников и прогнозирование оттока работников

## Цель работы

Выполнить прогноз покупательской активности постоянных клиентов интернет-магазина и предложить способ увеличения их покупательской активности (одного или нескольких сегментов клиентов).

## Планируемое использование результата работы

Результаты работы будут использованы руководством организации для дальнейшей планирования развития отношений с постоянными клиентами в целях увеличения их покупательской активности. 

## Входные данные

Для проведения работы разработаны подходы к необходимым исходным данным, переданы в соответствующие подразделения организации и дата-инженерам для сбора. В частности:
1. Промаркированы уровень финансовой активности постоянных покупателей. В компании принято выделять два уровня активности: «снизилась», если клиент стал покупать меньше товаров, и «прежний уровень».
2. Собраны данные по клиентам по следующим группам: 
    - Признаки, которые описывают коммуникацию сотрудников компании с клиентом.
    - Признаки, которые описывают продуктовое поведение покупателя. Например, какие товары покупает и как часто.
    - Признаки, которые описывают покупательское поведение клиента. Например, сколько тратил в магазине.
    - Признаки, которые описывают поведение покупателя на сайте. Например, как много страниц просматривает и сколько времени проводит на сайте.
3. Получены данные финансового департамента о прибыльности клиента: какой доход каждый покупатель приносил компании за последние три месяца.

## Задачи работы

1. Разработать модель машинного обучения, которая предскажет вероятность снижения покупательской активности в следующие три месяца.
2. Выделить сегменты покупателей и разработать для них персонализированные предложения.
   
## Критерий качества от заказчика

- по задаче № 1 критерий успеха - метрика SMAPE < 15 на тестовой выборке.
- по задаче № 2 критерий успеха - метрика ROC-AUC > 0.91 на тестовой выборке.

## Теги
`Python`, `Pandas`, `Matplotlib`, `Scikit-learn`, `shap`, `feature importance`

## Результаты и выводы

Для проведения исследования была получена выборка из 1300 записей о пользователях интернет-магазина с указанием категории их покупательской активности. Были выявлены некоторые проблемы с входными данными, требующие предобработки: пропуски в данных, возможные дубликаты. Проведена предобработка данных, их исследовательский анализ и подготовка к обучению.

В результате поиска лучшей модели с использованием подбора гиперпараментров по сетке из четырех моделей KNeighborsClassifier(), DecisionTreeClassifier(), LogisticRegression(), SVC() лучшей признана модель SVC(). Метрика TPR лучшей модели на тренировочной выборке составила 0.769.  Метрика TPR (RECALL) лучшей модели на тестовой выборке: 0.829, метрика ROC-AUC лучшей модели на тестовой выборке: 0.915.

В результате работы проведе анализ важности признаков, даны рекомендации по повышению покупательской активности пользователей.

Таким образом, в результате работы:
- разработана и интерпретирована модель машинного обучения с лучшими параметрами прогнозирования снижения активности пользователей.
- определены наиболее важные и неважные признаки снижения активности пользователей;
- сформулированы предложения по повышению покупательской активности пользователей.

## Достижение цели работы

Цель исследования достинута - на основании исходных данных с использованием моделей машинного обучения выполнен прогноз покупательской активности постоянных клиентов интернет-магазина и предложены способы увеличения их покупательской активности.