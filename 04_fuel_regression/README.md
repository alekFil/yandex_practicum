# Разработка модели для предсказания региона, где добыча нефти принесет наибольшую прибыль

## Цель работы

Построить модель, которая предскажет регион, где добыча нефты принесет наибольшую прибыль.

## Планируемое использование результата работы

Результаты работы будут использованы заказчком при выборе региона для дальнейшей разработки.

## Входные данные

Заказчик предоставил данные с пробами нефти в трех регионах: в каждом 10 000 месторождений, где измерили качество нефти и объём её запасов. Все сведения представлены в 3 таблицах с полями: id — уникальный идентификатор скважины; f0, f1, f2 — ключевые признаки скважин; product — объём запасов в скважине (тыс. баррелей).

## Задачи работы

1. Разработать модель машинного обучения (МО) для предсказания объемов запасов в скважинах. Проверить ее качество.
2. Расчитать прибыль и риски убытков для каждого из представленных регионов.

## Критерий качества от заказчика

- При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.
- Бюджет на разработку скважин в регионе — 10 млрд рублей.
- При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.
- После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них необходимо выбирать регион с наибольшей средней прибылью.

## Теги
`Python`, `Pandas`, `Scikit-learn`, `bootstrap`

## Результаты и выводы

Для проведения исследования была полученые выборки из 300_000 записей с пробами нефти в трех регионах: в каждом 10 000 месторождений, где измерили качество нефти и объём её запасов. Явных проблем с входными данными, требующих предобработки, не выявлено. Сделаны предположения о наличии дубликатов. Проведена предобработки данных, их исследовательский анализ и подготовка к обучению. 

В результате проведенной работы по обучению моделей достигнуты следующие результаты:
1. Исследуемые метрики RMSE моделей регионов на _тестовых_ данных следующие:
    - 1 регион - 37.74;
    - 2 регион - 0.89;
    - 3 регоин - 40.26.
2. Выявлены показатели среднего предсказанного объема запасов скважин в каждом регионе: от 68.50 до 94.80 тыс. баррелей.
2. В регионах могут быть исследованы только 500 скважин. В работе проведена оценка возможности возврата инвестиций и получения прибыли среди исследованных 500 скважин для 200 лучших скважин, предсказанных нашими моделями - расчитана прибыль от реализации 200 лучших скважин (по мнению моделей МО) в каждом регионе: ROI от 24% до 31%.
3. Техникой Bootstrap осуществлена оценка распределения прибыли от разработки 200 лучших скважин из 500 случайно исследованных скважин в зависимости от выборки пятисот скважин с учетом качества разработанной нами модели. Расчитаны средняя прибыль от разработки скважин, 95%-й доверительный интервал прибыли и существующие риски получения убытков.
4. С учетом полученных результатов выявлено:
    - лучшая средняя прибыль достигается в первом регионе;
    - 95% выборок скважин для исследования обеспечивают исключительно **прибыль** только во втором регионе, в других регионах возможны убытки;
    - риск убытков удовлетворяет условию заказчика (меньше 2,5%) только во втором регионе: показатель 1,3%.
    - во втором регионе средняя прибыль чуть меньше первого региона.
5. С связи с изложенным, предлагается осуществить разработку скважин _во втором регионе_.

## Достижение цели работы

Построена модель МО, которая предскажет регион, где добыча нефты принесет наибольшую прибыль. В частности, модель МО для второго региона показывает перспективность разработки указанного региона. Цель работы  достигнута.

## Рекомендации бизнесу (дальнейшая работа)

В результате работы выявлено, что нативные модели достаточно хорошо предсказывают объем запасов скважин в каждом регионе и позволяют оценить перспективность разработки скважин в регионе. В то же время предсказание объемов запасов скважин в других регионах (например, новых) на нативных моделях даст очевидно не самый лучший результат. В связи с этим, предлагается продолжить анализ модели, обученной на консолидированных данных. 