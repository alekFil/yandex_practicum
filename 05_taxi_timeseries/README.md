# Разработка модели для предсказания количество заказов такси на следующий час

## Цель работы

Построить модель, которая предскажет количество заказов такси на следующий час на основе данных о заказах такси в аэропортах в прошлые периоды (исторические данные).

## Планируемое использование результата работы

Результаты работы будут использованы в бизнесе заказчика, чтобы привлекать больше водителей в период пиковой нагрузки.

## Входные данные

Заказчик предоставил исторические данные о заказах такси в аэропортах.

## Задачи работы

1. Подготовить данные для формирования модели.
2. Разработать несколько моделей машинного обучения (МО) для предсказания.
3. Оценить качество работы моделей. Выбрать лучшую модель.
4. Протестировать лучшую модель.

## Критерий качества от заказчика

- Значение метрики RMSE на тестовой выборке должно быть не больше 48.

## Теги
`Python`, `Pandas`, `statsmodels`, `Scikit-learn`, `CatBoost`, `GridSearchCV`, `Pipeline`

## Результаты и выводы

Для проведения исследования была получена выборка из 26496 записей. Данные сведения о времени замера количества заказов и количество заказов такси каждые 10 минут. Данные представляют собой один временной ряд. Проведена предобработки данных, их исследовательский анализ и подготовка к обучению. 

В результате проведенной работы по обучению моделей достигнуты следующие результаты:
1. Были обучены три модели и оценена метрика для предсказаний константой.
2. Модель случайного предсказания DummyRegressor() показала метрику хуже предсказания константой. Другие модели - лучше. Все модели адекватны.
3. Лучшую метрике RMSE из обученных моделей показала LinearRegressor() c масштабированием входных признаков.
4. Получены сводные данные количественных показателей критериев всех моделей для дальнейшего анализа.

В результате анализа времени обучения, времени предсказания и качества моделей сделаны следующие выводы:
1. Модель LinearRegressor() превосходит все модели по качеству предсказаний.
2. Модель DecisionTreeRegressor() также самая быстрая в обучении.
3. Модель DecisionTreeRegressor() самая быстрая в предсказании.

В связи с тем, что основным критерием выбора модели является ее метрика RMSE. То лучшей моделью была признана модель LinearRegressor().

В результате проведенной работы лучшая модель для заказчика - LinearRegressor(), которая показала качество на тестовой выборе: **RMSE 34.191**, что меньше критерия заказчика. Кроме того, выявлено, что наибольшую важность сыграл признак, сформированный путем "сдвига" временного ряда на 4 дня, 2 дня. В части "сдвигов" на часовые промежутки, важную роль играют "сдвиги" на 21-24 часа. 

## Достижение цели работы

Построена модель МО, которая предсказывает количество заказов на следующий час в пределах определенных требований к ее качеству. Цель работы достигнута.